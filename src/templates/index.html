{% extends "layout.html" %} {% block title %} BibTex -lähdehallintatyökalu {%
endblock %} {% block body %}

<button id="add-source-btn" class="circle" title="Lisää lähde">
    <i class="fa-solid fa-plus"></i>
</button>

<form action="/source" method="POST" id="add-source-form">
    <div class="inner">
        <div class="top-row">
            <h2>Lisää lähde</h2>
            <button class="close" type="button">
                <i class="fa-solid fa-x"></i>
            </button>
        </div>

        <div class="content">
            <label for="type">Tyyppi</label>
            <select name="type">
                <option value="book">Kirja</option>
            </select>

            <label for="bibtex_key">Avain</label>
            <input
                type="text"
                name="bibtex_key"
                placeholder="Avain"
                oninput="this.value = this.value.replace(/[^0-9a-zA-Z]/, '')"
            />

            <label for="title">Otsikko</label>
            <input type="text" name="title" placeholder="Otsikko" />

            <label for="author">Kirjoittaja</label>
            <input type="text" name="author" placeholder="Kirjoittaja" />

            <label for="publisher">Julkaisija</label>
            <input type="text" name="publisher" placeholder="Julkaisija" />

            <label for="year">Vuosi</label>
            <input
                type="text"
                oninput="this.value = this.value.replace(/[^0-9]/, '')"
                name="year"
                placeholder="Vuosi"
            />

            <button type="submit" class="btn primary">Lisää</button>
        </div>
    </div>
</form>

<script>
    const addSourceBtn = document.getElementById('add-source-btn');
    const addSourceForm = document.getElementById('add-source-form');
    const addSourceFormSubmitButton = document.querySelector(
        '#add-source-form button[type="submit"]',
    );
    const addSourceFormCloseButton = document.querySelector(
        '#add-source-form button.close',
    );

    addSourceBtn.onclick = () => {
        addSourceForm.classList.add('show');
    };

    const closeAddSourceForm = () => addSourceForm.classList.remove('show');

    addSourceFormCloseButton.onclick = closeAddSourceForm;

    window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeAddSourceForm();
    });
</script>

{% endblock %}
